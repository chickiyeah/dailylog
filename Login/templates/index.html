<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="../static/css/reset.css">
  <link rel="stylesheet" href="../static/css/style.css">
  <link rel="stylesheet" href="../static/css/map.css">
  <title>Daily log</title>
</head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    $(document).ready(function () {
        if(document.cookie.includes("id=")){
            login = true
            if(document.cookie.split("id=")[1].includes(";")){
                id = document.cookie.split("id=")[1].split(";")[0].replace(" ","")
            }else{
                id = document.cookie.split("id=")[1].replace(" ","")
            }
        }else{
            login = false
        }

        $.ajax({
            url:"/Good_Say",
            method:"GET",
            success: function(response) {
                console.log(response)
                document.getElementById("good_say").innerHTML = response.message
                document.getElementById("good_say_author").innerHTML = response.author
            }
        })
    })
</script>
<body>
    <div>
        <!-- 헤더 시작 -->
        <header id="header">
            <div>
                <a href="/"><h1>DAILY<br>LOG</h1></a>
            </div>
            <!-- 네비 시작 -->
            <nav id="nav">
                <ul>
                    <li><a href="/map">지도보기</a></li>
                    <li><a href="/write/2">기록하기</a></li>
                    <li><a href="#">랭킹보기</a></li>
                    <li><a href="/Mypage">마이페이지</a></li>
                </ul>
            </nav>
            <!-- 네비 끝 -->
            <div class="nav_icon">
                <img src="../static/assets/search.png" alt="메뉴의 검색 아이콘">
                <img src="../static/assets/like.png" alt="메뉴의 좋아요 아이콘">
                <img src="../static/assets/mypage.png" alt="메뉴의 마이페이지 아이콘">
            </div>
        </header>
        <div class="top_hr">
            <hr>
        </div>
        <!-- 헤더 끝 -->
        <!-- 메인시작 -->
        <main id="main">
            <section class="content">
                <!-- story -->
                <div class="main_banner">
                    <div>
                        <p>내 지난 story</p>
                    </div>
                    <div class="bannerslide">
                        <div>
                            <img src="../static/assets/story_img1.png" alt="스토리 이미지1">
                            <img src="../static/assets/story_img1.png" alt="스토리 이미지2">
                            <img src="../static/assets/story_img1.png" alt="스토리 이미지3">
                        </div>
                    </div>
                </div>

                <!-- place -->
                <div class="main_place">
                    <div>
                        <p>내 지난 place</p>
                    </div>
                    <div>
                        <div class="map_wrap">
                            <div id="map" style="width:1000px; height:500px;"></div>
                            <div class="hAddr">
                                <span class="title">지도중심기준 주소정보</span>
                                <span id="centerAddr"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- menu -->
                <div class="main_menu">
                    <div class="main_text">
                        <p>new</p>
                        <h3>오늘은</h3>
                        <h3>이 메뉴 어때요?</h3>
                    </div>
                    <div>
                        <img src="../static/assets/menu/american/steak.png" alt="한식">
                        <h4>스테이크</h4>
                    </div>
                </div>

                <!-- phone -->
                <div class="main_phone">
                    <div>
                        <p>new</p>
                        <h3>오랜만에</h3>
                        <h3>연락해봐요 : )</h3>
                    </div>
                    <div class="phone_name">
                        <div>
                            <h6>김철수</h6>
                            <h6>24 days ago</h6>
                        </div>
                    </div>
                </div>

                <!--  famous saying -->
                <div class="saying">
                    <div class="saying_text">
                        <p id="good_say">눈동자로 상대방의 마음을 읽어라. 눈은 마음의 창이다.</p>
                        <p id="good_say_author">- 그라시아 -</p>
                    </div>
            </section>
        </main>
        <!-- 메인 끝 -->

        <!-- 푸터 시작 -->
        <footer id="footer">
            <div class="bottom_hr">
                <hr>
            </div>
            <div>
                <p>Copyright 2022 . DAILYLOG . All Rights Reserved .</p>
                <p>전체서비스 이용약관 개인정보처리방침 통합검색 고객센터 © DAILY LOG</p>
            </div>
        </footer>
        <!-- 푸터 끝 -->
    </div>




        <!-- 지도 스크립트 -->
        <!-- 모든 라이브러리 적용 상태 -->
        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=4c43d4733daa8022e6465b441f59f10c&libraries=services,clusterer,drawing"></script>
    
        <script>
        let mapContainer = document.getElementById('map'), // 지도를 표시할 div 
            mapOption = {
                center: new kakao.maps.LatLng(37.566826, 126.9786567), // 지도의 중심좌표
                level: 1 // 지도의 확대 레벨
            };  
    
        // 지도를 생성합니다    
        let map = new kakao.maps.Map(mapContainer, mapOption); 
    
        // 주소-좌표 변환 객체를 생성합니다
        let geocoder = new kakao.maps.services.Geocoder();
    
        let marker = new kakao.maps.Marker(), // 클릭한 위치를 표시할 마커입니다
            infowindow = new kakao.maps.InfoWindow({zindex:1}); // 클릭한 위치에 대한 주소를 표시할 인포윈도우입니다
    
        // 현재 지도 중심좌표로 주소를 검색해서 지도 좌측 상단에 표시합니다
        searchAddrFromCoords(map.getCenter(), displayCenterInfo);
    
        // 지도를 클릭했을 때 클릭 위치 좌표에 대한 주소정보를 표시하도록 이벤트를 등록합니다
        kakao.maps.event.addListener(map, 'click', function(mouseEvent) {
            searchDetailAddrFromCoords(mouseEvent.latLng, function(result, status) {
                if (status === kakao.maps.services.Status.OK) {
                    let detailAddr = !!result[0].road_address ? '<div>도로명주소 : ' + result[0].road_address.address_name + '</div>' : '';
                    detailAddr += '<div>지번 주소 : ' + result[0].address.address_name + '</div>';
                    
                    let content = '<div class="bAddr">' +
                                    '<span class="title">주소정보</span>' + 
                                    detailAddr + 
                                '</div>';
    
                    // 마커를 클릭한 위치에 표시합니다 
                    marker.setPosition(mouseEvent.latLng);
                    marker.setMap(map);
    
                    // 인포윈도우에 클릭한 위치에 대한 법정동 상세 주소정보를 표시합니다
                    infowindow.setContent(content);
                    infowindow.open(map, marker);
                }   
            });
        });
    
        // 중심 좌표나 확대 수준이 변경됐을 때 지도 중심 좌표에 대한 주소 정보를 표시하도록 이벤트를 등록합니다
        kakao.maps.event.addListener(map, 'idle', function() {
            searchAddrFromCoords(map.getCenter(), displayCenterInfo);
        });
    
        function searchAddrFromCoords(coords, callback) {
            geocoder.coord2RegionCode(coords.getLng(), coords.getLat(), callback);         
        }
    
        function searchDetailAddrFromCoords(coords, callback) {
            geocoder.coord2Address(coords.getLng(), coords.getLat(), callback);
        }
    
        // 지도 좌측상단에 지도 중심좌표에 대한 주소정보를 표출하는 함수입니다
        function displayCenterInfo(result, status) {
            if (status === kakao.maps.services.Status.OK) {
                let infoDiv = document.getElementById('centerAddr');
    
                for(let i = 0; i < result.length; i++) {
                    // 행정동의 region_type 값은 'H' 이므로
                    if (result[i].region_type === 'H') {
                        infoDiv.innerHTML = result[i].address_name;
                        break;
                    }
                }
            }    
        }
        </script>
</body>

</html>